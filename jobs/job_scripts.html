

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Job Scripts &mdash; Sigma2/Metacenter documentation  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Running scientific software" href="running-scientific-software.html" />
    <link rel="prev" title="Job Types" href="choosing_job_types.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> Sigma2/Metacenter documentation
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">News</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://opslog.sigma2.no">Latest changes and events</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.sigma2.no/hardware-status">Hardware live status</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting help</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_help/support_line.html">Support line</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_help/how_to_write_good_support_requests.html">Writing good support requests</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_help/qa-sessions.html">Open Question &amp; Answer Sessions for All Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_help/lost_forgotten_password.html">Lost or expiring password</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_help/project_leader_support.html">Project leader support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_help/advanced_user_support.html">Advanced User Support (AUS)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_help/publish_research_data.html">Publish Research Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_help/course_resources.html">CRaaS - Course Resources as a Service</a></li>
</ul>
<p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../frontpage.html">The Norwegian Academic HPC Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/applying_account.html">How do I get an HPC account?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/applying_resources.html">Applying for computing and storage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/training.html">Training material</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/create_ssh_keys.html">SSH</a></li>
</ul>
<p class="caption"><span class="caption-text">HPC Machines</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hpc_machines/hardware_overview.html">Overview over our machines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hpc_machines/betzy.html">Betzy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hpc_machines/fram.html">Fram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hpc_machines/saga.html">Saga</a></li>
<li class="toctree-l1"><a class="reference external" href="https://hpc-uit.readthedocs.io">Stallo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hpc_machines/migration2metacenter.html">Migration to a Metacenter HPC machine</a></li>
</ul>
<p class="caption"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../software/modulescheme.html">Software Module Scheme</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/installed_software.html">Installed Software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/containers.html">Running Singularity and Docker containers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/appguides.html">Application guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/userinstallsw.html">How can I, as a user, install software for myself or my project with EasyBuild?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/userinstallsw.html#how-can-i-as-user-install-python-packages">How can I as user install Python packages?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../software/licenses.html">Licenses and access policies</a></li>
</ul>
<p class="caption"><span class="caption-text">Jobs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="submitting.html">Submitting jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="choosing_job_types.html">Job Types</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Job Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#job-script-basics">Job Script Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#wall-time-limit">Wall Time Limit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#further-topics">Further Topics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#footnotes">Footnotes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="running-scientific-software.html">Running scientific software</a></li>
<li class="toctree-l1"><a class="reference internal" href="monitoring.html">Monitoring jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="choosing_memory_settings.html">How to choose the right amount of memory</a></li>
<li class="toctree-l1"><a class="reference internal" href="common_job_failures.html">Common job failures</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">How to check the performance and scaling using Arm Performance Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="interactive_jobs.html">Interactive jobs</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects_accounting.html">Projects and accounting</a></li>
<li class="toctree-l1"><a class="reference internal" href="network-access.html">No network access on compute nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="dos_and_donts.html">Dos and Don’ts</a></li>
<li class="toctree-l1"><a class="reference internal" href="guides.html">Guides</a></li>
</ul>
<p class="caption"><span class="caption-text">Files and Storage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../files_storage/nird.html">NIRD - National Infrastructure for Research Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../files_storage/clusters.html">Storage areas on HPC clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../files_storage/backup.html">Backup on Betzy, Fram, Saga, and NIRD</a></li>
<li class="toctree-l1"><a class="reference internal" href="../files_storage/sharing_files.html">Data handling and storage policy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../files_storage/file_transfer.html">File transfer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../files_storage/performance.html">Storage performance tuning</a></li>
</ul>
<p class="caption"><span class="caption-text">Code Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code_development/building.html">Building scientific software</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_development/compilers.html">Compilers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../code_development/performance.html">Performance Analysis and Tuning</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Sigma2/Metacenter documentation</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Job Scripts</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/UNINETTSigma2/documentation/blob/master/jobs/job_scripts.md" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="job-scripts">
<h1>Job Scripts<a class="headerlink" href="#job-scripts" title="Permalink to this headline">¶</a></h1>
<p>This page documents the basics of how to write job scripts for the HPC clusters.
Cluster-specific details are kept in separate sub pages for each cluster.</p>
<div class="section" id="job-script-basics">
<h2>Job Script Basics<a class="headerlink" href="#job-script-basics" title="Permalink to this headline">¶</a></h2>
<p>To run a <em>job</em> on the cluster involves creating a shell script called
a <em>job script</em>.  The job script is a plain-text file containing any
number of commands, including your main computational task, i.e., it
may copy or rename files, cd into the proper directory, etc., all
before doing the “real” work.  The lines in the script file are the
commands to be executed, in the given order.  Lines starting with a
<code class="docutils literal notranslate"><span class="pre">#</span></code> are ignored as comments, except lines that start with <code class="docutils literal notranslate"><span class="pre">#SBATCH</span></code>,
which are not executed, but contain special instructions to the queue
system.</p>
<p>If you are not familiar with shell scripts, they are simply a set of
commands that you could have typed at the command line.  You can find
more information about shell scripts here: <a class="reference external" href="http://www.linuxconfig.org/Bash_scripting_Tutorial">Introduction to Bash shell
scripts</a>.</p>
<p>A job script consists of a couple of parts, in this order:</p>
<ul class="simple">
<li><p>The first line, which is always <code class="docutils literal notranslate"><span class="pre">#!/bin/bash</span></code><a class="footnote-reference brackets" href="#id2" id="id1">2</a></p></li>
<li><p>Paremeters to the queue system</p></li>
<li><p>Commands to set up the execution environment</p></li>
<li><p>The actual commands you want to be run</p></li>
</ul>
<p>Parameters to the queue system may be specified on the <code class="docutils literal notranslate"><span class="pre">sbatch</span></code>
command line and/or in <code class="docutils literal notranslate"><span class="pre">#SBATCH</span></code> lines in the job script.  There can
be as many <code class="docutils literal notranslate"><span class="pre">#SBATCH</span></code> lines as you want, and you can combine several
parameters on the same line.  If a parameter is specified both on the
command line and in the job script, the parameter specified on the
command line takes precedence.  The <code class="docutils literal notranslate"><span class="pre">#SBATCH</span></code> lines must precede any
commands in the script.</p>
<p>Which parameters are allowed or required depends the job type and
cluster, but two parameters must be present in (almost) any job:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">--account</span></code>, which specifies the <em>project</em> the job will run in.
Required by all jobs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">--time</span></code>, which specifies how long a job should be allowed to
run.  If it has not finished within that time, it will be cancelled.</p></li>
</ul>
<p>The other parameters will be described in the sub pages for each cluster.</p>
<p>It is recommended to start the commands to set up the environment with</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span> -o errexit  <span class="c1"># Exit the script on any error</span>
<span class="nb">set</span> -o nounset  <span class="c1"># Treat any unset variables as an error</span>

module --quiet purge  <span class="c1"># Reset the modules to the system default</span>
</pre></div>
</div>
<p>and will most likely include one or more</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module load SomeProgram/SomeVersion
</pre></div>
</div>
<p>to set up environment variables like <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> to get access to the
specified programs.  It is recommended to specify the explicit version
in the <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span></code> command.  We also recommend adding a</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>module list    <span class="c1"># For easier debugging</span>
</pre></div>
</div>
<p>after the <code class="docutils literal notranslate"><span class="pre">module</span> <span class="pre">load</span></code> commands.  See <span class="xref myst">Software Module
Scheme</span> for more information about software
modules.</p>
<p>All in all, a generic job script might look like this:</p>
<p><span class="xref myst">include</span></p>
<p>Download the script: <a
href="files/generic_job.sh">generic_job.sh</a> (you might have
to right-click and select <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">Link</span> <span class="pre">As...</span></code> or similar).</p>
</div>
<div class="section" id="wall-time-limit">
<h2>Wall Time Limit<a class="headerlink" href="#wall-time-limit" title="Permalink to this headline">¶</a></h2>
<p>The wall time limit (<code class="docutils literal notranslate"><span class="pre">--time</span></code>) is required for all jobs.</p>
<p>The most used formats for the time specification is <code class="docutils literal notranslate"><span class="pre">DD-HH:MM:SS</span></code>
and <code class="docutils literal notranslate"><span class="pre">HH:MM:SS</span></code>, where <em>DD</em> is days, <em>HH</em> hours, <em>MM</em> minutes and <em>SS</em>
seconds.  For instance:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">3-12:00:00</span></code>: 3.5 days</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">7:30:00</span></code>: 7.5 hours</p></li>
</ul>
<p>We recommend you to be as precise as you can when specifying the wall
time limit as it will inflict on how fast your jobs will start to
run:  It is easier for a short job to get started between two larger,
higher priority jobs (so-called <em>backfilling</em>).  On the other hand, if
the job has not finished before the wall time limit, it will be
cancelled, so too long is better than too short due to lost work!</p>
</div>
<div class="section" id="further-topics">
<h2>Further Topics<a class="headerlink" href="#further-topics" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="job_scripts/environment_variables.html"><span class="doc std std-doc">Environment variables available in job scripts</span></a></p></li>
<li><p><a class="reference internal" href="job_scripts/work_directory.html"><span class="doc std std-doc">Job work directory</span></a></p></li>
<li><p><a class="reference internal" href="job_scripts/array_jobs.html"><span class="doc std std-doc">Array jobs</span></a></p></li>
<li><p><span class="xref myst">Running Job Steps in Parallel</span></p></li>
<li><p><span class="xref myst">Porting Job Scripts from PBS/Torque</span></p></li>
<li><p><span class="xref myst">Running MPI Jobs</span></p></li>
</ul>
</div>
<div class="section" id="footnotes">
<h2>Footnotes<a class="headerlink" href="#footnotes" title="Permalink to this headline">¶</a></h2>
<hr class="docutils" />
<dl class="footnote brackets">
<dt class="label" id="id2"><span class="brackets"><a class="fn-backref" href="#id1">2</a></span></dt>
<dd><p>Technically, any script language that uses <code class="docutils literal notranslate"><span class="pre">#</span></code> as a comment character can be used, but the recommended, and the only one supported by the Metacenter, is bash.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="running-scientific-software.html" class="btn btn-neutral float-right" title="Running scientific software" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="choosing_job_types.html" class="btn btn-neutral float-left" title="Job Types" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Sigma2/Metacenter

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>